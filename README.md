# bx_order
Компонент оформления заказа.

Распространяется под лицензией [MIT](https://en.wikipedia.org/wiki/MIT_License). Автор не принимает на себя никаких гарантийных обязательств в отношении данного компонента и не несет ответственности за:

  * любой прямой или косвенный ущерб и упущенную выгоду, даже если это стало результатом использования или невозможности использования компонента;
  * убытки, включая общие, предвидимые, реальные, прямые, косвенные и прочие убытки, включая утрату или искажение информации, убытки, понесенные Пользователем или третьими лицами, невозможность работы компонента и несовместимость с любым другим модулем, компонентом и т.д.
  * за любые повреждения оборудования или программного обеспечения Пользователя, возникшие в результате использовании компонента.

-----------------------------------
**Описание:**

В компоненте создаётся объект заказа. В объект передаются все установленные либо настройками, либо посредством "$_REQUEST" данные. Формируются отгрузки. Далее созданный объект используется для получения складов, способов доставки, платёжных систем, с учётом правил фильтрации. Рассчитываются все скидки и наценки установленные маркетинговыми правилами работы с корзиной. Купон на скидку необходимо передавать в "$_REQUEST['PROMO']". Если при вызове компонента передаётся "$_REQUEST['SAVE'] == 'Y'", то происходит сохранение заказ в базе данных, при отсутствии ошибок. Если запрос к странице на которой расположен компонент происходит методом AJAX, то компонент возвращает весь $arResult в виде JSON.

В данный момент не реализован механизм настройки компонента в пользовательской части сайта посредством эрмитажа. Сделаю это позже. Ниже перечислен список параметров на данный момент.

-----------------------------------
**Перечень параметров:**

```php
'PERSON_TYPE_ID'
```
_ID типа плательщика, если необходимо предустановить. Если не передано устанавливается из "$_REQUEST['PERSON_TYPE_ID']". Не обязательный_

```php
'IMAGE_WIDTH'
```
_Ограничение по ширине изображений товаров. Не обязательный._

```php
'IMAGE_HEIGHT'
```
_Ограничение по высоте изображений товаров. Не обязательный_

```php
'NEW_USER_LOGIN_FIELD'
```
_Поле формы заказа по которому будет проводиться поиск по логинам имеющихся пользователей, в случе неавторизованного покупателя. По умолчанию это 'EMAIL'_

```php
'DELIVERY_ID'
```
_ID доставки, если необходимо предустановить как по умолчанию. Если не передано устанавливается из "$_REQUEST['DELIVERY_ID']". По умолчанию 0_

```php
'PAYMENT_ID'
```
_ID платёжной системы, если необходимо предустановить как по умолчанию. Если не передано устанавливается из "$_REQUEST['PAYMENT_ID']". По умолчанию 0_

```php
'USE_ORDER_NUMBER'
```
_Если установлен как 'Y', в место ID заказа будет использоваться номер (AccountNumber)_

```php
'PATH_TO_SUCCESS'
```
_Путь к странице с сообщением об успешном оформлении, если установлен, то на него будет происходить редирект._

```php
'NO_PHOTO'
```
_Путь до изображения устанавливаемого в случае отсутствия у какого либо товара. обычно это "заглушка" типа "NO PHOTO"._

```php
'PROPERTY_LIST'
```
_Список символьных кодов товаров которые нужно получить для отображения._

```php
'NEW_USER_EVENT_CODE'
```
_Код почтового события для отправки информационного письма с регистрационными данными новому пользователю при его создании. Если не передан, то письмо отправляться не будет._
